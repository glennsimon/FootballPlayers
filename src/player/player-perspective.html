<html>
  <head> </head>
  <body>
    <div class="wrapper">
      <div class="floorZ">
        <div class="floorX">
          <div class="floorY">
            <div class="field">
              <div class="field-objective"></div>
            </div>
            <div class="waist">
              <div class="torso">
                <div class="surface__text torso__front">88</div>
                <div class="torso__back">
                  <div class="surface__text name">FLINTSTONE</div>
                  <div class="surface__text number">88</div>
                </div>
                <div class="torso__right"></div>
                <div class="torso__left"></div>
                <div class="torso__top"></div>
                <div class="torso__bottom"></div>
              </div>
              <div class="leg__left">
                <div class="thigh">
                  <div class="thigh__front"></div>
                  <div class="thigh__back"></div>
                  <div class="thigh__right"></div>
                  <div class="thigh__left"></div>
                  <div class="thigh__top"></div>
                  <div class="thigh__bottom"></div>
                </div>
                <div class="knee">
                  <div class="calf">
                    <div class="calf__front"></div>
                    <div class="calf__back"></div>
                    <div class="calf__right"></div>
                    <div class="calf__left"></div>
                    <div class="calf__top"></div>
                    <div class="calf__bottom"></div>
                  </div>
                  <div class="foot">
                    <div class="foot__front"></div>
                    <div class="foot__back"></div>
                    <div class="foot__right"></div>
                    <div class="foot__left"></div>
                    <div class="foot__top"></div>
                    <div class="foot__bottom"></div>
                  </div>
                </div>
              </div>
              <div class="leg__right">
                <div class="thigh">
                  <div class="thigh__front"></div>
                  <div class="thigh__back"></div>
                  <div class="thigh__right"></div>
                  <div class="thigh__left"></div>
                  <div class="thigh__top"></div>
                  <div class="thigh__bottom"></div>
                </div>
                <div class="knee">
                  <div class="calf">
                    <div class="calf__front"></div>
                    <div class="calf__back"></div>
                    <div class="calf__right"></div>
                    <div class="calf__left"></div>
                    <div class="calf__top"></div>
                    <div class="calf__bottom"></div>
                  </div>
                  <div class="foot">
                    <div class="foot__front"></div>
                    <div class="foot__back"></div>
                    <div class="foot__right"></div>
                    <div class="foot__left"></div>
                    <div class="foot__top"></div>
                    <div class="foot__bottom"></div>
                  </div>
                </div>
              </div>
              <div class="pads">
                <div class="arm__left">
                  <div class="shoulder">
                    <div class="shoulder__front"></div>
                    <div class="shoulder__back"></div>
                    <div class="shoulder__right"></div>
                    <div class="shoulder__left"></div>
                    <div class="shoulder__top"></div>
                    <div class="shoulder__bottom"></div>
                  </div>
                  <div class="upper">
                    <div class="upper__front"></div>
                    <div class="upper__back"></div>
                    <div class="upper__right"></div>
                    <div class="upper__left"></div>
                    <div class="upper__top"></div>
                    <div class="upper__bottom"></div>
                  </div>
                  <div class="elbow">
                    <div class="lower">
                      <div class="lower__front"></div>
                      <div class="lower__back"></div>
                      <div class="lower__right"></div>
                      <div class="lower__left"></div>
                      <div class="lower__top"></div>
                      <div class="lower__bottom"></div>
                    </div>
                  </div>
                </div>
                <div class="arm__right">
                  <div class="shoulder">
                    <div class="shoulder__front"></div>
                    <div class="shoulder__back"></div>
                    <div class="shoulder__right"></div>
                    <div class="shoulder__left"></div>
                    <div class="shoulder__top"></div>
                    <div class="shoulder__bottom"></div>
                  </div>
                  <div class="upper">
                    <div class="upper__front"></div>
                    <div class="upper__back"></div>
                    <div class="upper__right"></div>
                    <div class="upper__left"></div>
                    <div class="upper__top"></div>
                    <div class="upper__bottom"></div>
                  </div>
                  <div class="elbow">
                    <div class="lower">
                      <div class="lower__front"></div>
                      <div class="lower__back"></div>
                      <div class="lower__right"></div>
                      <div class="lower__left"></div>
                      <div class="lower__top"></div>
                      <div class="lower__bottom"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="neck">
                <div class="head">
                  <div class="head__front">
                    <div class="eyes">@&nbsp;&nbsp;&nbsp;@</div>
                    <div class="mouth">XXXX</div>
                  </div>
                  <div class="head__right"></div>
                  <div class="head__left"></div>
                  <div class="head__bottom"></div>
                </div>
                <div class="helmet">
                  <div class="shield__top"></div>
                  <div class="shield__back"></div>
                  <div class="helmet__trim helmet__back"></div>
                  <div class="surface__text helmet__trim helmet__right">S</div>
                  <div class="surface__text helmet__trim helmet__left">S</div>
                  <div class="helmet__trim helmet__top"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      // const faces = ['bottom', 'top', 'left', 'right', 'front', 'back'];
      const volumes = {
        torso: [1, 19, 6, 6, 4.5, 4.5],
        thigh: [14, 2, 2.5, 2.5, 2.5, 2.5],
        calf: [15, 1, 2, 2, 2, 2],
        foot: [0, 2, 2, 2, 6, 2],
        shoulder: [3, 3, 3, 3, 3, 3],
        upper: [11, 1, 2, 2, 2, 2],
        lower: [10, 2, 1.5, 1.5, 1.5, 1.5],
        head: [0.5, 6.5, 3.5, 3.5, 4, 4],
        helmet: [0, 10, 5, 5, 5, 5],
      };

      const offsets = {
        waist: 30,
        knee: -14,
        foot: -16,
        pads: 16,
        elbow: -12,
        neck: 20,
        corner: 3,
        leg: 3,
        arm: 8,
      };

      const fieldWidth = 2040;
      const fieldHeight = 920;
      const viewportWidth = 800;
      const viewportHeight = 450;
      // let zScale = 2.173;
      let zScale = 1;
      let playerVector = [320, 320, 0];
      let objectiveVector = [
        (fieldWidth / 2 + playerVector[0]) / 2,
        (fieldHeight / 2 + playerVector[1]) / 2,
        8 * zScale,
      ];
      const cameraVector = [
        fieldWidth / 2,
        fieldHeight / 2 + 640,
        400 * zScale,
      ];
      let sightlineVector = cameraVector.map((item, index) => {
        return item - objectiveVector[index];
      });
      let sightlineDistance =
        (sightlineVector[0] ** 2 +
          sightlineVector[1] ** 2 +
          sightlineVector[2] ** 2) **
        0.5;
      let sightUnitVector = sightlineVector.map((item, index) => {
        return item / sightlineDistance;
      });
      const fieldUnitVector = [0, 0, 1];
      let transformVector = sightUnitVector.map((item, index) => {
        return item - fieldUnitVector[index];
      });
      let psi =
        (180 *
          Math.atan(
            sightlineVector[2] /
              (sightlineVector[0] ** 2 + sightlineVector[1] ** 2) ** 0.5
          )) /
        Math.PI;
      let theta =
        (180 * Math.atan(sightlineVector[0] / sightlineVector[1])) / Math.PI;

      const holding = `transform-origin: ${cameraVector[0]}px ${
        cameraVector[1]
      }px;
        transform: perspective(${sightlineDistance}px) translateY(200px) rotateX(${psi}deg) rotateZ(${theta}deg) translate3d(0px, 0px, 0px)
        left: ${640 - objectiveVector[0]}px;
        top: ${360 - objectiveVector[1]}px;
        transform-origin: ${objectiveVector[0]}px ${objectiveVector[1]}px;
        ;`;

      const style = document.createElement('style');
      style.innerHTML = `
      * {
        box-sizing: border-box;
        position: absolute;
        backface-visibility: inherit;
        font-family: fantasy;
        // transform-style: preserve-3d;
      }
      body {
        margin: 0;
        padding: 0;
        background: transparent;
      }
      .wrapper {
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
      }
      .floorZ {
        left: ${-playerVector[0]}px;
        top: ${-playerVector[1]}px;
        width: ${2 * playerVector[0]}px;
        height: ${2 * playerVector[1]}px;
        transform: translateZ(-400px) rotateZ(0deg);
        // transform-origin: ${objectiveVector[0]}px ${objectiveVector[1]}px;
        // transform: perspective(${sightlineDistance}px) 
        // translateZ(${-cameraVector[2]}px) 
        // rotateX(${90 - psi}deg) rotateZ(${theta}deg);
      }
      .floorX {
        left: ${-playerVector[0]}px;
        width: ${2 * playerVector[0]}px;
        transform: perspective(883px) translateX(1020px);
        transform-style: preserve-3d;
        // transform-origin: ${objectiveVector[0]}px ${objectiveVector[1]}px;
        // transform: perspective(${sightlineDistance}px) 
        // translateZ(${-cameraVector[2]}px) 
        // rotateX(${90 - psi}deg) rotateZ(${theta}deg);
      }
      .floorY {
        left: ${-playerVector[0]}px;
        top: ${-playerVector[1]}px;
        width: ${2 * playerVector[0]}px;
        height: ${2 * playerVector[1]}px;
        transform-origin: 0 1100px;
        transform: rotateX(0deg);
        // transform-style: preserve-3d;
        // transform-origin: ${objectiveVector[0]}px ${objectiveVector[1]}px;
        // transform: perspective(${sightlineDistance}px) 
        // translateZ(${-cameraVector[2]}px) 
        // rotateX(${90 - psi}deg) rotateZ(${theta}deg);
      }
      .surface__text {
        display: flex;
        justify-content: center;
        align-items: center;
        backface-visibility: hidden;
        font-size: 4px;
        color: white;
      }
      .buttons {
        display: flex;
        flex-direction: column;
      }
      button {
        position: static;
      }
      .outline {
        left: ${objectiveVector[0] - viewportWidth / 2}px;
        top: ${objectiveVector[1] - viewportHeight / 2}px;
        width: ${viewportWidth}px;
        height: ${viewportHeight}px;
        background: rgba(255,255,255,0.3);
      }
      .waist {
        left: ${playerVector[0]}px;
        top: ${playerVector[1]}px;
      }
      .field-objective {
        left: ${objectiveVector[0] - 10}px;
        top: ${objectiveVector[1] - 10}px;
        width: 20px;
        height: 20px;
        background: white;
        clip-path: polygon(
          9px 0, 11px 0, 11px 9px, 20px 9px, 20px 11px,
          11px 11px, 11px 20px, 9px 20px, 9px 11px, 0px 11px,
          0px 9px, 9px 9px, 9px 0 );
      }
      .torso div {
        font-size: 10px;
        background: red;
      }
      .torso__back {
        display: flex;
        flex-direction: column;
      }
      .torso__back .name {
        font-size: 2px;
        position: static;
        margin: auto;
      }
      .torso__back .number {
        position: static;
        margin: auto;
      }
      .shoulder div {
        background: red;
      }
      .head div {
        background: Sienna;
      }
      .helmet div {
        color: red;
        background: white;
      }
      .shield__top {
        left: ${-volumes.helmet[3]}px;
        top: ${-volumes.helmet[5]}px;
        width: ${volumes.helmet[1]}px;
        height: ${volumes.helmet[1]}px;
        transform: translateZ(${volumes.helmet[1] - offsets.corner}px)
      }
      .shield__back {
        transform: translateY(${volumes.helmet[5] - offsets.corner}px)
      }
      .thigh div {
        background: white;
      }
      .calf div {
        background: white;
      }
      .foot div {
        background: black;
      }
      .upper div {
        background: Sienna;
      }
      .lower div {
        background: Sienna;
      }
      .head__front {
        display: flex;
        flex-direction: column;
      }
      .eyes {
        position: static;
        margin: auto;
        color: black;
        font-size: 2.4px;
        font-weight: bold;
      }
      .mouth {
        position: static;
        margin: auto;
        color: white;
        font-size: 2.4px;
        font-weight: bold;
      }
      .helmet__trim {
        clip-path: polygon(${offsets.corner}px 0px, ${
        volumes.helmet[1] - offsets.corner
      }px 0px,
        ${volumes.helmet[1]}px ${offsets.corner}px,
        ${volumes.helmet[1]}px ${volumes.helmet[1] - offsets.corner}px,
        ${volumes.helmet[1] - offsets.corner}px ${volumes.helmet[1]}px,
        ${offsets.corner}px ${volumes.helmet[1]}px,
        0px ${volumes.helmet[1] - offsets.corner}px, 0px ${offsets.corner}px, ${
        offsets.corner
      }px 0px);
      }
      @keyframes fieldMotion {
        to {transform: translateY(-600px);}
      }
      @keyframes rotate15 {
        from {transform: rotateX(45deg)}
        to {transform: rotateX(45deg) rotateZ(360deg)}
      }
      @keyframes swing45 {
        33% {
          transform: rotateX(45deg);
        }
        66% {
          transform: rotateX(-45deg);
        }
      }
      @keyframes swing45_60 {
        33% {
          transform: rotateX(45deg);
        }
        66% {
          transform: rotateX(-60deg);
        }
      }
      @keyframes kneeSwingWalk {
        66% {
          transform: translateZ(${offsets.knee}px) rotateX(-30deg);
        }
      }
      @keyframes kneeSwingRun {
        66% {
          transform: translateZ(${offsets.knee}px) rotateX(-90deg);
        }
      }
      @keyframes elbows30 {
        to {
          transform: translateZ(${offsets.elbow}px) rotateX(30deg);
        }
      }
      @keyframes elbows90 {
        to {
          transform: translateZ(${offsets.elbow}px) rotateX(90deg);
          animation-timing-function: ease-in;
        }
      }
      @keyframes flip {
        from {
          transform: translateZ(${offsets.waist}px) rotateX(0deg);
        }
        to {
          transform: translateZ(${offsets.waist}px) rotateX(360deg);
        }
      }
      `;

      const parts = Object.keys(volumes);
      const faces = ['bottom', 'top', 'left', 'right', 'front', 'back'];
      for (const part of parts) {
        for (const face of faces) {
          let index = faces.indexOf(face);
          if (index < 2) {
            style.innerHTML += `.${part}__${face} {
              left: ${-volumes[part][2]}px;
              top: ${-volumes[part][5]}px;
              width: ${volumes[part][2] + volumes[part][3]}px;
              height: ${volumes[part][4] + volumes[part][5]}px;
              transform: rotateY(${index === 1 ? 0 : 180}deg) translateZ(${
              volumes[part][index]
            }px);
            }
            `;
          } else if (index < 4) {
            style.innerHTML += `.${part}__${face} {
              left: ${
                (volumes[part][3] -
                  volumes[part][2] -
                  volumes[part][4] -
                  volumes[part][5]) /
                2
              }px;
              top: ${
                (volumes[part][4] -
                  volumes[part][5] -
                  volumes[part][1] -
                  volumes[part][0]) /
                2
              }px;
              width: ${volumes[part][4] + volumes[part][5]}px;
              height: ${volumes[part][0] + volumes[part][1]}px;
              transform: translateZ(${
                (volumes[part][1] - volumes[part][0]) / 2
              }px) rotateX(-90deg) rotateY(${
              index === 3 ? -90 : 90
            }deg) translateZ(${(volumes[part][2] + volumes[part][3]) / 2}px);
            }
            `;
          } else {
            style.innerHTML += `.${part}__${face} {
              left: ${-volumes[part][2]}px;
              top: ${
                (volumes[part][4] -
                  volumes[part][5] -
                  volumes[part][1] -
                  volumes[part][0]) /
                2
              }px;
              width: ${volumes[part][2] + volumes[part][3]}px;
              height: ${volumes[part][0] + volumes[part][1]}px;
              transform: translateZ(
              ${(volumes[part][1] - volumes[part][0]) / 2}px)
              rotateX(-90deg) rotateY(
                ${index === 4 ? 0 : 180}deg)
                translateZ(${(volumes[part][4] + volumes[part][5]) / 2}px);
            }
            `;
          }
        }
      }

      style.innerHTML += `
      .waist {
        transform: translateZ(${offsets.waist}px);
      }
      .leg__left {
        left: ${offsets.leg}px;
      }
      .leg__right {
        left: ${-offsets.leg}px;
      }
      .knee {
        transform: translateZ(${offsets.knee}px);
      }
      .foot {
        transform: translateZ(${offsets.foot}px);
      }
      .pads {
        transform: translateZ(${offsets.pads}px);
      }
      .arm__left {
        left: ${offsets.arm}px;
      }
      .arm__right {
        left: ${-offsets.leg}px;
      }
      .elbow {
        transform: translateZ(${offsets.elbow}px);
      }
      .neck {
        transform: translateZ(${offsets.neck}px);
      }
      `;
      document.head.appendChild(style);

      const animation = document.createElement('style');

      function stand() {
        animation.innerHTML = '';
      }

      function walk() {
        animation.innerHTML = `
      .arm__right {
        animation: 1s 0.5s infinite linear swing45;
      }
      .arm__left {
        animation: 1s infinite linear swing45;
      }
      .leg__right {
        animation: 1s infinite linear swing45;
      }
      .leg__left {
        animation: 1s 0.5s infinite linear swing45;
      }
      .knee {
        animation: 0.5s infinite linear kneeSwingWalk;
      }
      .elbow {
        animation: 0.5s forwards elbows30;
      }
      `;
      }

      function run() {
        animation.innerHTML = `
      .arm__right {
        animation: 0.5s 0.25s infinite linear swing45_60;
      }
      .arm__left {
        animation: 0.5s infinite linear swing45_60;
      }
      .leg__right {
        animation: 0.5s infinite linear swing45_60;
      }
      .leg__left {
        animation: 0.5s 0.25s infinite linear swing45_60;
      }
      .knee {
        animation: 0.25s infinite linear kneeSwingRun;
      }
      .elbow {
        animation: 0.5s forwards elbows90;
      }
      `;
      }

      function flip() {
        animation.innerHTML = `
      .waist {
        animation: 1s forwards flip;
      }
      `;
      }

      const direction = document.createElement('style');

      function faceNorth() {
        direction.innerHTML = `
        .waist {
          transform: translateZ(${offsets.waist}px) rotateZ(180deg);
        }`;
      }

      function faceEast() {
        direction.innerHTML = `
        .waist {
          transform: translateZ(${offsets.waist}px) rotateZ(-90deg);
        }`;
      }

      function faceSouth() {
        direction.innerHTML = `
        .waist {
          transform: translateZ(${offsets.waist}px);
        }`;
      }

      function faceWest() {
        direction.innerHTML = `
        .waist {
          transform: translateZ(${offsets.waist}px) rotateZ(90deg);
        }`;
      }

      document.body.appendChild(animation);
      document.body.appendChild(direction);
    </script>
  </body>
</html>
